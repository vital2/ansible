---
- hosts: Computer-Networks
  become: yes
  tasks:
    - name: Install Software for Computer Networks Lab
      apt:
        pkg: "{{ item }}"
        state: present
      with_items:
        - scapy
        - iptables
        - wireshark
        - ebtables
        - ufw
        - nmap
        - quagga
        - ftp
        - isc-dhcp-server
        - ntp
        - iperf
        - iperf3
        - echoping
        - tftp
        - telnet
        - mate-desktop-environment-extras
        - mate-themes
        - lightdm
        - lightdm-gtk-greeter
        - ubuntu-artwork
        - update-manager
        - traceroute
        - tree
        - snmp
        - psad
        - quagga-doc


    - name: Copy Configuration files
      copy:
        src: ~/ansible/ComputerNetworks/CN_R1/configuration-files/
        dest: /etc/


    - name: Copy Lightdm Configuration files
      copy:
        src: ~/ansible/ComputerNetworks/CN_R1/lightdm/
        dest: /etc/lightdm/

    - name: Copy installation script
      copy:
        src: ~/ansible/ComputerNetworks/CN_R1/installation.sh
        dest: /tmp/

    - name: Run the Installation script
      shell: sh /tmp/installation.sh

    - name: Enable lightdm
      shell: "{{ item }}"
      with_items:
        - ln -s /lib/systemd/system/lightdm.service /etc/systemd/systemd/display-manager.service
        - systemctl enable lightdm.service

    - name: Disable dhcpd
      shell: systemctl disable isc-dhcp-server
